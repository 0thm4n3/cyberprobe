<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html>
<head>
<title>cyberprobe - configuration</title>

<style type="text/css">

    body {  font: 10pt helvetica; background: white; }

    table { border-collapse: collapse; margin: 12px; }
    th { border: 1px solid black; padding: 6px; background: #f0f0f0; }
    td { border: 1px solid black; padding: 6px; }

    pre { border: 1px solid #e0e0e0; background: #ffffe8; margin: 12px; padding: 12px; font: 10pt courier; }

    .xmlcomment { color: #4040ff; }

</style>

</head>
<body>
<h1>Cyberprobe - Configuration</h1>

<h2>Table of contents</h2>

<ul>
<li><a href="index.html">Index</a></li>
<li><a href="quickstart.html">Quick Start</a></li>
<li><a href="config.html">Configuration</a></li>
<li><a href="output.html">Output streaming protocols</a></li>
<li><a href="management.html">Management interface</a></li>
</ul>

<h2>Configuration</h2>

<p>
The configuration file is re-read when it changes, and changes are
immediately actioned.
</p>

<p>
Sample configuration:
</p>

<pre>
&lt;?xml version="1.0" encoding="ISO-8859-1"?>

&lt;configuration>

  &lt;!-- Start a control interface on port 8888. -->
  &lt;control port="8888" username="admin" password="horse_battery_staple">

  &lt;!-- Set of interfaces to use for collection. -->
  &lt;interfaces>

    &lt;!-- filter element is optional.  Can be used to make sure you don't
         sniff the outbound streams. -->
    &lt;interface name="eth0" filter="not port 10001 and not port 10002"/>

    &lt;-- The delay attribute can be used to specify a delay before packets
           are processed.  In seconds. --> 
    &lt;interface name="eth1" delay="1"/>

  &lt;/interfaces>

  &lt;!-- Statically targeted addresses. -->
  &lt;targets>
    &lt;target address="192.168.1.1" liid="123456"/>
    &lt;target address="192.168.1.2" liid="123981"/>
    &lt;target address="10.1.1.1" liid="9123780"/>
    &lt;target address="10.1.1.0" liid="591875"/>
    &lt;target address="10.1.1.2" liid="492895"/>
    &lt;target address="10.1.1.3" liid="591875"/>
    &lt;target address="10.1.1.4" liid="591875"/>
    &lt;target address="10.1.1.5" liid="591875"/>
    &lt;target address="10.1.1.6" liid="591875"/>
    &lt;target address="10.1.1.7" liid="591875"/>
    &lt;target address="10.1.1.8" liid="591875"/>
    &lt;target address="10.1.1.9" liid="591875"/>
    &lt;target address="10.1.1.10" liid="591875"/>
    &lt;target address="::4:5:6" liid="983898"/>
  &lt;/targets>

  &lt;!-- Endpoints for delivery of collected packets. -->
  &lt;endpoints>

    &lt;!-- Send collected packets to monitor1:10001 in NHIS 1.1 stream. -->
    &lt;endpoint hostname="monitor1" port="10001" type="nhis1.1"/>

    &lt;!-- Send collected packets to monitor2:10002 in ETSI LI stream. -->
    &lt;endpoint hostname="monitor2" port="10002" type="etsi"/>

  &lt;/endpoints>

  &lt;!-- Set of parameters, primarily used to configure the metadata in
       ETSI LI metadata. -->
  &lt;parameters>

    &lt;!-- Value used for deliveryCountryCode and authorizationCountryCode
         in LI PS PDU. Should be 2-character string. -->
    &lt;parameter key="country" value="DE"/>

    &lt;!-- Value used for operatorIdentifier in LI PS PDU. A string up to 16
         characters. -->
    &lt;parameter key="operator" value="Cyber"/>

    &lt;!-- Value used for networkElementIdentifier in LI PS PDU. String up
         to 16 characters in length. -->
    &lt;parameter key="network_element" value="10.8.2.4"/>

    &lt;!-- Value used for interceptionPointID in LI PS PDU. String up
         to 8 characters in length. -->
    &lt;parameter key="interception_point" value="abcd1234"/>

    &lt;!-- Username values used in IPIRI connection.  Key form is
         "username." plus the LIID -->
    &lt;parameter key="username.123456" value="user01@example.org"/>
    &lt;parameter key="username.123981" value="user02@example.org"/>
    &lt;parameter key="username.981235" value="user03@example.org"/>

    &lt;!-- Parameters in this form are used select the LIID which is used
         when packets are collected on Snort alerts.  Basically, this maps
	 the Snort signature ID to a LIID. -->
    &lt;parameter key="snort.1.liid" value="SNORT1"/>
    &lt;parameter key="snort.2.liid" value="SNORT2"/>

   &lt;/parameters>

   &lt;!-- Optional element.  Listens for Snort alerts, and dynamically targets
        addresses for 60 seconds. -->
   &lt;!--
   &lt;snort_alert socket="/var/log/snort/snort_alert" duration="60"/>
   -->

&lt;/configuration>
</pre>

<p>
The <code>control</code> element is optional, if it exists, cyberprobe
runs a management interface on the specified port.  The port, username and
password attributes must be specified.
See <a href="management.html">management interface</a> for how to communicate
with that interface.
</p>

<p>
The <code>interfaces</code> block defines a set of interfaces to sniff.
The <code>name</code> attribute is mandatory, the <code>filter</code>
element is optional.  The <code>delay</code> element can be used to
specify, in seconds, the duration to wait before packets are processed.
</p>

<p>
The <code>targets</code> block defines an IP address to LIID mapping.
The <code>address</code> attribute defines the IP address used to match
on, and the <code>liid</code> attribute defines the LIID which will be
applied if this particular IP address is detected.  The address must be
an IP address, and not a hostname.  The address can be an IPv6 address if
the <code>class</code> attribute is included, and set to <code>ipv6</code>.
</p>

<p>
LIIDs can occur in multiple places in the target block, but 
an IP address should only occur once in the target block.
</p>

<p>
The <code>endpoints</code> block defines a set of addresses for delivery.
The <code>hostname</code> and <code>port</code> attributes should be used to
describe the endpoint address.  Type <code>type</code> attribute should be
<code>nhis1.1</code> or <code>etsi</code> to specify which output stream
format to use.
</p>

<p>
The optional <code>parameters</code> block defines a set of parameters which
are only used in ETSI delivery.  Each <code>parameter</code> element
should have a <code>key</code> and a <code>value</code> attribute.
The parameter values for <code>country</code>, <code>operator</code>,
<code>network_element</code> and <code>interception_point</code> describe
values which are used in the PSHeader and IRI constructs.
The parameters with prefix <code>username.</code> describe values for the
username values in the IPIRI construct in ETSI LI.  The key value is the
<code>username.</code> suffixed with the LIID.  If such an entry is present,
it is used for the username.  All parameters are optional, meaningless
defaults (e.g. <code>unknown</code>) will be used if not specified.
</p>

</body>

</html>

